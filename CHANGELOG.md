# Changelog

All notable changes to this project will be documented in this file.

The format is based on [Keep a Changelog](https://keepachangelog.com/en/1.0.0/), and this project adheres to [Semantic Versioning](https://semver.org/spec/v2.0.0.html).

## [Unreleased]

### Added

- 通知：通知为空时显示“通知为空”提示。

### Fixed

- 更新：修复更新页中获取最新一个版本的更新记录时内容为空的问题。

### Changed

- 帖子：更新楼层中网页链接的样式，现在和bbcode编辑器相同。
- 编辑：编辑器插入网页链接时，不再自动加`https://`前缀。
- 网页：更新解析网页时标签`<li>`的样式。

## [0.8.0] - 2024.3.31

### Added

- 编辑：提供实验性的富文本bbcode编辑器，初步支持所见即所得。
  - 显示文本样式包括字体大小、粗体、斜体、下划线、删除线、字体颜色、背景色。
  - 支持插入表情、图片和网页链接。
  - 目前尚未做反向的解析bbcode，从普通编辑器切换到富文本时已有内容依然是纯文本属于正常现象，未来会支持。
  - 表情会从论坛下载，大约15MB，注意流量。
  - 在编辑器左下角图标切换普通编辑器和富文本编辑器。
- 帖子：解析更多的折叠/展开样式。
  - 现在支持\<details\> tag。
- 更新：更新页面可查看完整更新历史。
  - 右上角按钮。

### Fixed

- 帖子: 依旧是修复了楼层中很多多余或缺少的空行。
- 帖子：未登录时禁用回复框并提示需要登录。
- 帖子：修复切换楼层浏览排序（正序/倒序）后帖子当前页数不正确的问题。
- 首页：修复一些加载首页时无限转圈的问题。

### Changed

- 帖子：嵌套的卡片现在内层比外层高，以作区分。
- 帖子：更改展开/折叠区域的按钮样式，更明显。
- internal: 从Equatable迁移到dart_mappable。

## [0.7.1] - 2024-02-23

### Fixed

- app：修复Windows平台构建

## [0.7.0] - 2024-02-23

### Added

- 帖子：显示悬赏状态及对应的最佳答案。
- 帖子：支持编辑已发布的帖子。
  - 楼层右下角菜单 -> 编辑。
  - 一些附加选项可能不完全支持。
  - 暂不支持设置阅读权限和售价。
- 帖子：显示帖子楼层的最后编辑状态，包括时间和用户名。
- 帖子：帖子内按页数显示分组。
- 帖子：现在发送回复后会提示发送成功。
- 帖子：解析分割线\<hr\>。
- 消息：支持显示批量评分类型的提醒。
- 消息：在通知页内显示已有x条相同通知被忽略。
- 积分：支持筛选积分变更历史。
- app：现在在安卓和IOS上尝试使用和当前语言的应用标题。

### Fixed

- 积分：修复积分统计页面我的积分标签页中缺少空隙的问题。
- 帖子：修复部分楼层丢失字体颜色的问题。
- 我的帖子：修复我的帖子页面的丢失最新一条回复的问题。
- 消息：修复了离开消息详情页面后依然更新state导致异常的问题。
- app: 修复了很多处解析html时多余或缺少换行的问题。

### Changed

- 帖子：现在引用的文本用双引号包裹，而不是在一块更“高”的Card里。
  - 涉及评分通知、帖子楼层内引用的文本。
- 消息：高亮显示消息中的帖子标题和积分变动。
- internal: 支持flutter 3.19。
- internal: 去除安卓gradle构建脚本中标记为弃用的部分。
- internal: 提高最低依赖版本：flutter 3.19和dart 3.3。

## [0.6.0] - 2024-02-08

### Added

- 新增提示帖子内的红包已经领完了。
- 新增支持看帖时只看某个作者的楼层。
  * 楼层右下角菜单 -> 只看该作者/看所有作者。
- 新增支持看帖时倒序浏览。
  * 帖子右上角菜单 -> 倒序浏览/正序浏览。
- 新增支持从好友邀请参与话题的消息跳转到相应帖子。
- 新增支持筛选帖子。
- 新增支持查看新添加的好友的提醒。~~虽然加好友请求的提醒还没做~~
- 新增显示积分的统计信息和积分的变更记录的页面。
  * 我的 -> 右上角统计信息按钮。
- 在首页和我的页面内提醒有未读的消息。
  * 有提醒时显示提醒数量，只有短消息时显示红点。
  * 默认开启，可在设置中关闭。
- 在消息提醒卡片上显示是多久以前的消息。~~终于分得清哪个是哪个了~~
- 缓存首页轮播图。

### Fixed

- 修复无法解析部分带有投票的楼层的问题。
- 修复无法解析部分带有隐藏区域的楼层的问题。
- 修复上个版本引入的无法解析购买区域的问题。
- 修复更新页面无法跳转到github release的问题。
- 修复部分楼层中处于\<dl\>和\<dd\>标签内的内容无法显示的问题。
- 修复部分楼层中自定义字体周围多余换行的问题。

### Changed

- 不再显示被设置为不显示的html节点。

## [0.5.1] - 2024-01-31

### Fixed

- 修复了不显示仅作者可见的回复区域的问题。
- 修复了主页中展示的分类置顶贴分类标注顺序错误的问题。

### Changed

- 尝试打包MacOS和iOS平台的产物。
- 尝试支持MacOS和iOS平台的应用内更新。
- 现在更新页面中会始终显示跳转到github release的按钮。
- 成功领取红包后关闭红包领取按钮。

## [0.5.0] - 2024-01-26

### Added

- 新增解析仅作者可见的帖子回复。
- 新增支持领取红包。
  - 但是应该还没有领取提示。
  - ~~太难测了，先将就一下。~~
- 加载图片时显示带微光的占位图片以提示加载状态。
- 分区页面的置顶标签页内显示版规。
- 分区页面的所有标签页均支持下拉刷新。
- 分区页面点击当前标签页时滚动当前页面到顶部。
- 支持从评分卡片和消息卡片上的用户头像和名称跳转到用户信息页。
- 支持从首页的用户头像和名称跳转到当前用户信息页面。

### Fixed

- 修复设置色调时没有显示当前使用的色调颜色的问题。
- 修复设置色调时对话框标题会随着滚动的问题。
- 修复访问没有权限查看的分区时没有提示的问题。
- 修复部分情况下在帖子里的图片加载失败时不显示默认图片的问题。
- 修复一些图片加载失败的问题。
- 修复个人信息页面向下滚动后无法滚动回顶部的问题。
- 修复图片在已有缓存的情况下依然闪烁一次的问题。
- 修复通知页面内点击用户名可跳转到用户信息页面的部分过宽的问题。
- 修复一些情况下加载图片失败时没有使用默认图片的问题。
- 修复从链接跳转过去的帖子缺少标题的问题。
- 修复从连接跳转过去的分区缺少标题的问题。
- 修复分区页面只能在帖子标签页刷新的问题。
- 修复分区页面在加载时右上角跳页的按钮可以点击的问题。
- 修复跳转到无权限访问的帖子时没有提示的问题。
- 修复帖子页面楼层尾部有多于空行的问题。
- 修复帖子页面内一些楼层中文字排版没有换行的问题。
- 修复帖子页面内发表回复后无法再次输入回复的问题。

### Changed

- 现在尝试给自己的回复评分时会显示不能评分的提示。

## [0.4.0] - 2024-01-21

### Added

- 新增支持旅行者主题。
- 新增支持给帖子评分。
- 当从网络请求拉取图片失败时，使用默认的图片logo。
- 现在首页，分区和个人资料页可以下拉刷新。
- 去除了首屏加载页，现在软件启动后直接进入首页。
- 现在设置页面中修改签到想说的话时默认显示当前想说的话，方便修改。
- 现在搜索页内刷新搜索结果时会隐藏之前的搜索结果。
- 现在消息页面内，评分消息如果评分理由为空，会隐藏评分理由。
- 现在会缓存我的提醒页面内选项卡中已加载的数据，不再在切换选项卡时刷新。

### Fixed

- 修复不属于任何分类的帖子的页面内标题为空的问题。
- 修复无法从帖子的艾特（@）查看用户信息的问题。
- 修复用户信息页面的头像在头像不可用时未使用默认头像的问题。
- 修复用户信息页面打开几秒后会闪烁一次的问题。
- 修复论坛和帖子页面内有时候无法下拉刷新的问题。
- 修复消息页内无法通过评分类型的消息跳转到相应帖子的问题。

### Changed

- 更新隐藏区域卡片上的按钮样式，更明显。
- 如果帖子的评分消息中评分理由为空，不显示评分理由。
- 登录后，加载首页的时机推迟到访问首页时，而不是登录后直接加载。
- 帖子已经加载完时不再显示toast，而是显示snack bar。
- internal: 从riverpod迁移到bloc。

## [0.3.0] - 2023-12-30

### Added

- 新增解析帖子名称的颜色和字重。
- 新增解析帖子分类和状态图标（已关闭，评分，投票，加精，置顶等）。
- 新增解析论坛页面中的置顶帖。
- 新增解析一级标题到四级标题。
- 新增解析代码块标签（\<code\>）。
- 新增设置->关于->开源许可页面。
- 新增设置颜色色调。
- 新增用户信息页面，支持从楼层和帖子卡片跳转。
- 在已被关闭的帖子内关闭回复栏。
- 解析无序列表时在文字前添加圆点。
- 支持检查和下载最新版本。
- 支持从提醒跳转到帖子对应楼层的页面（目前只能滚动到同一页）。

### Fixed

- 修复页面中时间显示和网页端有误差的问题。
- 修复帖子页面加载数据报错。
- 修复论坛页面跳页后子论坛标签页内容变空的问题。
- 修复论坛页面在子版块标签页内无法跳页的问题。
- 修复论坛卡片上的最新帖子无法跳转的问题。
- 修复帖子内发送回复后发送按钮依然可点击的问题。
- 修复论坛页面刷新时偶见的异常。
- 修复清除缓存时卡住的问题。
- 修复帖子内标题包含分区名等非标题信息的问题。
- 修复搜索页面可能在窄屏幕上溢出问题。

## [0.2.0] - 2023-12-22

### Added

- 新增解析帖子楼层正文`postmessage`中的隐藏部分。
- 新增解析帖子中由于积分不足而隐藏的部分。
- 新增解析帖子中回复后才可见的部分。
- 新增解析对帖子回复的点评。
- 新增解析帖子中的展开/折叠部分。
- 现在打开帖子中的链接时对支持的链接优先以页面的形式在应用内打开。
- 现在论坛页面和帖子页面支持电梯直达。
- 帖子的评分表支持左右滚动以适应屏幕过窄的情况。
- 现在在帖子页面的列表顶部会显示帖子ID和帖子分类。

### Fixed

- 修复无法在具有多个隐藏部分的帖子中购买的问题。
- 修复当帖子的回复评分为扣分时显示总评分为空的问题。
- 修复安卓上帖子标题下方空白和其他页面不一致的问题。
- 修复搜索页面中跳页的对话框默认选中的页不是当前页的问题。
- 修复解析帖子分类时失败的问题。
- 修复因为未解析`pre`标签导致部分楼层内容为空的问题。
- 修复帖子中某些文字段落之间的换行消失的问题。

### Changed

- 展示帖子回复中代码块的方式由下划线文本改为代码卡片。
- 帖子页面中楼层顶部的标题使用完整的标题。
- 分区页面的分区标签栏按左对齐。

## [0.1.1] - 2023-12-17

### Fixed

- 修复主页帖子跳转失败的问题。

## [0.1.0] - 2023-12-16

### Added

- 首个release，新增基本的登录，看帖，回复等功能。

